import os
import subprocess
import csv
cve_ids = [
"GHSA-2367-c296-3mp2, RUSTSEC-2018-0002",
"GHSA-28m8-9j7v-x499, RUSTSEC-2022-0088",
"GHSA-29c2-65rj-h343",
"GHSA-29v7-3v4c-gf38, RUSTSEC-2020-0134, GHSA-xwxc-j97j-84gf",
"GHSA-2f5j-3mhq-xv58, RUSTSEC-2020-0100",
"GHSA-2gg5-7c4v-6xx2, RUSTSEC-2022-0055, GHSA-m77f-652q-wwp4",
"GHSA-2hvr-h6gw-qrxp",
"GHSA-2rcp-jvr4-r259",
"GHSA-2xpx-vcmq-5f72",
"GHSA-3227-r97m-8j95",
"GHSA-3288-cwgw-ch86, GHSA-2xpg-3hx4-fm9r, GHSA-3cj3-jrrp-9rxf, RUSTSEC-2021-0019, GHSA-mp6r-fgw2-rxfx",
"GHSA-32v7-ghpr-c8hg, RUSTSEC-2019-0006, GHSA-g7r5-x7cr-vm3v",
"GHSA-36xm-35qq-795w, RUSTSEC-2023-0058",
"GHSA-37xq-q42p-rv3p",
"GHSA-3837-87vh-xq3w, GHSA-pfjq-935c-4895, RUSTSEC-2020-0127",
"GHSA-3cgf-9m6x-pwwr, GHSA-8h4j-vm3r-vcq3, GHSA-6q5w-m3c5-rv95, GHSA-g4w7-3qr8-5623, GHSA-rjh8-p66p-jrh5, GHSA-28ph-f7gx-fqj8, GHSA-q3cc-7p7g-392c, GHSA-8r7q-r9mx-35rh, RUSTSEC-2020-0014",
"GHSA-3fg9-hcq5-vxrc, RUSTSEC-2022-0049",
"GHSA-3jch-9qgp-4844, RUSTSEC-2021-0122",
"GHSA-3mf3-2gv9-h39j, RUSTSEC-2021-0014",
"GHSA-3qx3-6hxr-j2ch",
"GHSA-3r3g-g73x-g593",
"GHSA-3rcq-39xp-7xjp",
"GHSA-3w3h-7xgx-grwc, RUSTSEC-2022-0089",
"GHSA-43w2-9j62-hq99, RUSTSEC-2021-0003",
"GHSA-44mr-8vmm-wjhg, RUSTSEC-2022-0076",
"GHSA-45w7-7g63-2m5w, GHSA-8mjx-h23h-w2pg, RUSTSEC-2021-0033",
"GHSA-4mq4-7rw3-vm5j",
"GHSA-4rjr-3gj2-5crq",
"GHSA-4vhw-4rw7-jfpv, RUSTSEC-2020-0030",
"GHSA-4wm2-cwcf-wwvp",
"GHSA-52h2-m2cf-9jh6",
"GHSA-52xf-5p2m-9wrv",
"GHSA-55f3-3qvg-8pv5",
"GHSA-55m5-whcv-c49c, RUSTSEC-2018-0018, GHSA-66p5-j55p-32r9",
"GHSA-57fm-592m-34r7",
"GHSA-5873-6fwq-463f",
"GHSA-58j9-j2fj-v8f4",
"GHSA-5fm9-h728-fwpj, RUSTSEC-2023-0041",
"GHSA-5frw-4rwq-xhcr",
"GHSA-5gmm-6m36-r7jh, RUSTSEC-2023-0080",
"GHSA-5j8w-r7g8-5472, RUSTSEC-2022-0012",
"GHSA-5m39-wx2q-mxg3, RUSTSEC-2022-0067",
"GHSA-5wg8-7c9q-794v, GHSA-gmv4-vmx3-x9f3, GHSA-vh4p-6j7g-f4j9, GHSA-ppj3-7jw3-8vc4, GHSA-hj9h-wrgg-hgmx, RUSTSEC-2020-0070",
"GHSA-5wvv-q5fv-2388, RUSTSEC-2022-0072",
"GHSA-62jx-8vmh-4mcw, RUSTSEC-2021-0080",
"GHSA-64wv-8vwp-xgw2, GHSA-qj69-c89v-jwq2, RUSTSEC-2021-0090",
"GHSA-6698-mhxx-r84g",
"GHSA-67fv-9r7g-432h",
"GHSA-67hm-27mx-9cg7",
"GHSA-686f-ch3r-xwmh, GHSA-7mg7-m5c3-3hqj, RUSTSEC-2020-0116",
"GHSA-6878-6wc2-pf5h, RUSTSEC-2023-0068",
"GHSA-68p4-pjpf-xwcq, RUSTSEC-2021-0018",
"GHSA-69fv-gw6g-8ccg, RUSTSEC-2018-0011",
"GHSA-69gw-hgj3-45m7, RUSTSEC-2019-0012",
"GHSA-69vj-xx27-g45w, RUSTSEC-2020-0108",
"GHSA-6ggr-cwv4-g7qg, RUSTSEC-2023-0077",
"GHSA-6mv3-wm7j-h4w5",
"GHSA-6q4w-9x56-rmwq",
"GHSA-6r8p-hpg7-825g",
"GHSA-6wj2-g87r-pm62, RUSTSEC-2021-0063",
"GHSA-6wr5-jmpr-mjcx",
"GHSA-6x52-88cq-55q5",
"GHSA-75hq-h6g9-h4q5",
"GHSA-75jp-vq8x-h4cq",
"GHSA-7787-p7x6-fq3j, RUSTSEC-2023-0073",
"GHSA-779w-xvpm-78jx",
"GHSA-78wx-jg4j-5j6g",
"GHSA-7f6x-jwh5-m9r4",
"GHSA-7fw6-6mfj-g3q2",
"GHSA-7g9j-g5jg-3vv3, RUSTSEC-2024-0011",
"GHSA-7j36-gc4r-9x3r, RUSTSEC-2019-0015",
"GHSA-7p7c-pvvx-2vx3, RUSTSEC-2022-0069",
"GHSA-7v2r-wxmg-mgvc, RUSTSEC-2020-0031",
"GHSA-838h-jqp6-cf2f",
"GHSA-83r8-p8v6-6gfm, RUSTSEC-2020-0135, GHSA-mc36-5m36-hjh5",
"GHSA-853p-5678-hv8f",
"GHSA-862g-9h5m-m3qv",
"GHSA-88xq-w8cq-xfg7",
"GHSA-8928-2fgm-6x9x, RUSTSEC-2021-0081",
"GHSA-8mj7-wxmc-f424, RUSTSEC-2022-0028",
"GHSA-8mx2-gqx9-rm7f",
"GHSA-8r76-fr72-j32w",
"GHSA-8v4j-7jgf-5rg9, RUSTSEC-2022-0082",
"GHSA-8vxv-2g8p-2249, RUSTSEC-2022-0018",
"GHSA-969w-q74q-9j8v, RUSTSEC-2022-0070",
"GHSA-96jv-r488-c2rj, RUSTSEC-2023-0004",
"GHSA-9783-42pm-x5jq, GHSA-r67p-m7g9-gxw6, RUSTSEC-2021-0088",
"GHSA-99j7-mhfh-w84p, RUSTSEC-2022-0086",
"GHSA-9c9f-7x9p-4wqp, RUSTSEC-2022-0007",
"GHSA-9f5r-vqm5-m342, RUSTSEC-2021-0016",
"GHSA-9ggc-845v-gcgv",
"GHSA-9mxw-4856-9cm5, RUSTSEC-2020-0098",
"GHSA-9pqx-g3jh-qpqq, RUSTSEC-2020-0091",
"GHSA-9qmm-4mfr-r3wj",
"GHSA-9qwg-crg9-m2vc, RUSTSEC-2023-0023",
"GHSA-9v25-r5q2-2p6w",
"GHSA-c25x-cm9x-qqgx",
"GHSA-c2hf-vcmr-qjrf, RUSTSEC-2024-0358",
"GHSA-c3cw-c387-pj65, RUSTSEC-2018-0009",
"GHSA-c3hm-hxwf-g5c6, RUSTSEC-2024-0342",
"GHSA-c3m3-c39q-pv23, RUSTSEC-2019-0002",
"GHSA-c827-hfw6-qwvm",
"GHSA-c8v3-jhv9-4ppc, RUSTSEC-2024-0007",
"GHSA-c9rv-3jmq-527w, RUSTSEC-2020-0075",
"GHSA-cgqf-3cq5-wvcj",
"GHSA-ch89-5g45-qwc7",
"GHSA-cm8g-544f-p9x9, GHSA-q89g-4vhh-mvvm, GHSA-92cx-4xm7-jr9m, GHSA-g87r-23vw-7f87, RUSTSEC-2021-0128, GHSA-g4g4-3pqw-8m7f, GHSA-f6f2-3w33-54r9, GHSA-87xh-9q6h-r5cc, GHSA-4qr3-m7ww-hh9g",
"GHSA-cqpr-pcm7-m3jc, RUSTSEC-2020-0159",
"GHSA-cqvm-j2r2-hwpg",
"GHSA-cx4j-fxr7-jxg8, RUSTSEC-2021-0005",
"GHSA-f3pg-qwvg-p99c, RUSTSEC-2021-0078",
"GHSA-f56g-chqp-22m9, GHSA-6gvc-4jvj-pwq4, RUSTSEC-2020-0055, RUSTSEC-2018-0020",
"GHSA-f5v5-ccqc-6w36, RUSTSEC-2023-0027",
"GHSA-f67m-9j94-qv9j, RUSTSEC-2022-0022",
"GHSA-f6g6-54hm-fhxv, RUSTSEC-2020-0120",
"GHSA-ff4p-7xrq-q5r8",
"GHSA-fhvc-gp6c-h2wx, RUSTSEC-2021-0017",
"GHSA-fjr6-hm39-4cf9, RUSTSEC-2021-0009",
"GHSA-fjx5-qpf4-xjf2, RUSTSEC-2023-0033",
"GHSA-g98v-hv3f-hcfr, RUSTSEC-2021-0145",
"GHSA-gch5-hwqf-mxhp, RUSTSEC-2023-0048",
"GHSA-gh9f-6xm2-c4j2",
"GHSA-gpcv-p28p-fv2p",
"GHSA-gw5p-q8mj-p7gh",
"GHSA-gx5w-rrhp-f436",
"GHSA-h45v-vgvp-3h5v, RUSTSEC-2020-0042",
"GHSA-h84q-m8rr-3v9q",
"GHSA-h8jm-2x53-xhp5, RUSTSEC-2022-0065, GHSA-8rwr-x37p-mx23",
"GHSA-hhw2-pqhf-vmx2, RUSTSEC-2020-0045",
"GHSA-hjqq-29pw-96wj",
"GHSA-hpcx-3pw8-g3j2, RUSTSEC-2021-0046",
"GHSA-hv7x-f3pv-gpwr, RUSTSEC-2019-0013",
"GHSA-j3xp-wfr4-hx87",
"GHSA-j8qq-58cr-8cc7, RUSTSEC-2021-0008",
"GHSA-jjx5-3f36-6927, RUSTSEC-2021-0068",
"GHSA-jm4v-58r5-66hj",
"GHSA-jqwc-c49r-4w2x",
"GHSA-m24x-r6q3-2vp9",
"GHSA-m296-j53x-xv95, GHSA-fg42-vwxx-xx5j, RUSTSEC-2020-0118",
"GHSA-m3x9-623g-35c4",
"GHSA-m4pq-fv2w-6hrw",
"GHSA-m4vx-ccrf-w399",
"GHSA-m589-mv4q-p7rj",
"GHSA-m9m5-cg5h-r582, RUSTSEC-2020-0089",
"GHSA-mc22-5q92-8v85",
"GHSA-mc52-jpm2-cqh6",
"GHSA-mjw4-jj88-v687",
"GHSA-mpg5-fvwp-42m2, RUSTSEC-2022-0002",
"GHSA-mphm-gqh9-q59x",
"GHSA-p24j-h477-76q3, RUSTSEC-2021-0106",
"GHSA-p2g9-94wh-65c2, RUSTSEC-2022-0003",
"GHSA-p46c-w9m3-7qr2, GHSA-p56p-gq3f-whg8, RUSTSEC-2021-0086",
"GHSA-p9m5-3hj7-cp5r, RUSTSEC-2020-0061",
"GHSA-pf3p-x6qj-6j7q, RUSTSEC-2020-0081",
"GHSA-pjrj-h4fg-6gm4",
"GHSA-ppqp-78xx-3r38, RUSTSEC-2021-0015",
"GHSA-pr39-8257-fxc2",
"GHSA-px9g-8hgv-jvg2, RUSTSEC-2021-0143",
"GHSA-q3gg-m8hr-h4x4",
"GHSA-q445-7m23-qrmw, RUSTSEC-2024-0357",
"GHSA-q73f-w3h7-7wcc",
"GHSA-q879-9g95-56mx, GHSA-v4cp-h94r-m7xf, GHSA-4873-36h9-wv49, RUSTSEC-2021-0110",
"GHSA-q948-x8rf-888m, RUSTSEC-2020-0012",
"GHSA-q9h2-4xhf-23xx, RUSTSEC-2020-0096",
"GHSA-q9p4-hw9m-fj2v",
"GHSA-q9wv-22m9-vhqh",
"GHSA-qj3v-q2vj-4c8h, RUSTSEC-2021-0075",
"GHSA-qwhm-h7v3-mrjx",
"GHSA-qwvx-c8j7-5g75, RUSTSEC-2021-0112, GHSA-6692-8qqf-79jc",
"GHSA-r344-xw3p-2frj",
"GHSA-r64r-5h43-26qv",
"GHSA-r8w9-5wcg-vfj7",
"GHSA-r9rv-9mh8-pxf4",
"GHSA-rfj2-q3h3-hm5j",
"GHSA-rm4w-6696-r77p, RUSTSEC-2021-0021",
"GHSA-rpcm-whqc-jfw8, RUSTSEC-2019-0010",
"GHSA-rwf4-gx62-rqfw, RUSTSEC-2022-0029",
"GHSA-rxr4-x558-x7hw, RUSTSEC-2018-0003",
"GHSA-v5m7-53cv-f3hx, GHSA-m8h8-v6jh-c762, RUSTSEC-2020-0052",
"GHSA-v5wf-jg37-r9m5",
"GHSA-v935-pqmr-g8v9",
"GHSA-vhfr-v4w9-45v8, RUSTSEC-2019-0018",
"GHSA-vj88-5667-w56p, RUSTSEC-2020-0115, GHSA-fqq2-xp7m-xvm8",
"GHSA-vjrq-cg9x-rfjp, RUSTSEC-2017-0005",
"GHSA-vp68-2wrm-69qm, RUSTSEC-2022-0085",
"GHSA-vp6r-mrq9-8f4h, RUSTSEC-2020-0142, GHSA-r88h-6987-g79f",
"GHSA-vx24-x4mv-vwr5",
"GHSA-w277-wpqf-rcfv, RUSTSEC-2024-0010, GHSA-747x-5m58-mq97",
"GHSA-w3vp-jw9m-f9pm",
"GHSA-w47j-hqpf-qw9w, RUSTSEC-2021-0004",
"GHSA-w5w5-8vfh-xcjq, RUSTSEC-2024-0020",
"GHSA-w8vq-3hf9-xppx",
"GHSA-w9r2-qrpm-4rmj, RUSTSEC-2020-0150",
"GHSA-wh6w-3828-g9qf, RUSTSEC-2022-0075",
"GHSA-whc7-5p35-4ww2, RUSTSEC-2020-0046",
"GHSA-whhr-7f2w-qqj2",
"GHSA-wmff-grcw-jcfm",
"GHSA-wq8f-46ww-6c2h, RUSTSEC-2018-0001",
"GHSA-wrqv-pf6j-mqjp",
"GHSA-wrrj-h57r-vx9p",
"GHSA-wrvc-72w7-xpmj, RUSTSEC-2019-0026",
"GHSA-x4mq-m75f-mx8m, RUSTSEC-2022-0008",
"GHSA-x5j2-g63m-f8g4, RUSTSEC-2023-0079",
"GHSA-x7vr-c387-8w57, RUSTSEC-2019-0033, GHSA-xvc9-xwgj-4cq9",
"GHSA-x96g-95fq-4xv4",
"GHSA-xhg9-xwch-vr7x",
"GHSA-xm67-587q-r2vw",
"GHSA-xm9m-2vj8-fmfr, GHSA-wcvp-r8j8-47pc, RUSTSEC-2021-0028",
"GHSA-xmr7-v725-2jjr, RUSTSEC-2021-0026",
"GHSA-xqqc-c5gw-c5r5",
"GHSA-xr9w-x6gw-c9mj, GHSA-jc97-h3h9-7xh6",
"GHSA-xvcg-2q82-r87j, RUSTSEC-2019-0038, GHSA-wcxc-jf6c-8rx9",
"GHSA-xwqr-xmgg-j69q",
"RUSTSEC-2016-0002, GHSA-9xjr-m6f3-v5wm",
"RUSTSEC-2017-0001, GHSA-2wc6-2rcj-8v76",
"RUSTSEC-2017-0006, GHSA-mcrf-7hf9-f6q5",
"RUSTSEC-2018-0004, GHSA-8c6g-4xc5-w96c",
"RUSTSEC-2018-0005, GHSA-39vw-qp34-rmwf",
"RUSTSEC-2018-0006, GHSA-hv87-47h9-jcvq",
"RUSTSEC-2018-0010, GHSA-xjxc-vfw2-cg96",
"RUSTSEC-2018-0012, GHSA-gffv-5hr2-f9gj",
"RUSTSEC-2018-0013, GHSA-2v78-j59h-fmpf",
"RUSTSEC-2018-0014",
"RUSTSEC-2018-0016",
"RUSTSEC-2019-0007, GHSA-v5r6-6r3c-wqxc",
"RUSTSEC-2019-0009, GHSA-mm7v-vpv8-xfc3",
"RUSTSEC-2019-0011, GHSA-rh89-x75f-rh3c",
"RUSTSEC-2019-0014, GHSA-m2pf-hprp-3vqm",
"RUSTSEC-2019-0025, GHSA-xr7r-88qv-q7hm",
"RUSTSEC-2019-0027, GHSA-hrjm-c879-pp86",
"RUSTSEC-2019-0028, GHSA-gx73-2498-r55c",
"RUSTSEC-2019-0031",
"RUSTSEC-2019-0037, GHSA-24g6-5rx7-58wj, GHSA-r6ff-2q3c-v3pv",
"RUSTSEC-2019-0040",
"RUSTSEC-2020-0001, GHSA-4cww-f7w5-x525",
"RUSTSEC-2020-0003",
"RUSTSEC-2020-0006, GHSA-vqx7-pw4r-29rr",
"RUSTSEC-2020-0008, GHSA-h3qr-rq2j-74w4",
"RUSTSEC-2020-0009, GHSA-c9h5-hf8r-m97x",
"RUSTSEC-2020-0016",
"RUSTSEC-2020-0018",
"RUSTSEC-2020-0021, GHSA-8rc5-mr4f-m243",
"RUSTSEC-2020-0026, GHSA-r43h-gmrm-h5c9",
"RUSTSEC-2020-0028, GHSA-8q2v-67v7-6vc6",
"RUSTSEC-2020-0039, GHSA-hqc8-j86x-2764, GHSA-438g-fx34-4h9m",
"RUSTSEC-2020-0040, GHSA-85j6-f8j6-q26x",
"RUSTSEC-2020-0041, GHSA-rfgg-vccr-m46m, GHSA-64gv-qg2v-vxv6, GHSA-9p9m-9xww-qjcx, GHSA-mp6f-p9gp-vpj9, GHSA-x54v-qxxr-93qc, GHSA-fqpx-cq8x-9wp4",
"RUSTSEC-2020-0048, GHSA-v3j6-xf77-8r9c",
"RUSTSEC-2020-0057",
"RUSTSEC-2020-0059, GHSA-rh4w-94hh-9943",
"RUSTSEC-2020-0060, GHSA-r93v-9p5q-vhpf",
"RUSTSEC-2020-0062, GHSA-5r9g-j7jj-hw6c",
"RUSTSEC-2020-0063",
"RUSTSEC-2020-0067",
"RUSTSEC-2020-0068, GHSA-h7qh-3h6f-w79p",
"RUSTSEC-2020-0069, GHSA-vc2p-r46x-m3vx",
"RUSTSEC-2020-0072, GHSA-4hjg-cx88-g9f9",
"RUSTSEC-2020-0073, GHSA-9wgh-vjj7-7433",
"RUSTSEC-2020-0078, GHSA-c79c-gwph-gqfm",
"RUSTSEC-2020-0080, GHSA-jrcf-4jp8-m28v",
"RUSTSEC-2020-0082, GHSA-566x-hhrf-qf8m",
"RUSTSEC-2020-0094, GHSA-39xg-8p43-h76x",
"RUSTSEC-2020-0101, GHSA-3jc5-5hc5-33gj",
"RUSTSEC-2020-0103, GHSA-cgmg-2v6m-fjg7",
"RUSTSEC-2020-0112, GHSA-r7rv-2rph-hvhj",
"RUSTSEC-2020-0114, GHSA-3hj2-hh36-hv9v",
"RUSTSEC-2020-0117, GHSA-368f-29c3-4f2r",
"RUSTSEC-2020-0119, GHSA-gq4h-f254-7cw9, GHSA-77m6-x95j-75r5",
"RUSTSEC-2020-0122, GHSA-m7w4-8wp8-m2xq",
"RUSTSEC-2020-0123, GHSA-gvcp-948f-8f2p",
"RUSTSEC-2020-0124, GHSA-9j8q-m9x5-9g6j",
"RUSTSEC-2020-0131, GHSA-jh2g-xhqq-x4w9, GHSA-686h-j8r8-wmfm",
"RUSTSEC-2020-0151, GHSA-w3g5-2848-2v8r, GHSA-h6gg-fvf5-qgwf",
"RUSTSEC-2020-0152, GHSA-rmff-f8w9-c9rm",
"RUSTSEC-2020-0160, GHSA-978j-88f3-p5j3",
"RUSTSEC-2020-0162",
"RUSTSEC-2021-0012, GHSA-37jj-wp7g-7wj4",
"RUSTSEC-2021-0013, GHSA-hvqc-pc78-x9wh, GHSA-jrf8-cmgg-gv2m",
"RUSTSEC-2021-0020, GHSA-6hfq-h8hq-87mf",
"RUSTSEC-2021-0023, GHSA-w7j2-35mf-95p7",
"RUSTSEC-2021-0032, GHSA-8fgg-5v78-6g76",
"RUSTSEC-2021-0035, GHSA-fhv4-fx3v-77w6",
"RUSTSEC-2021-0036, GHSA-gppw-3h6h-v6q2",
"RUSTSEC-2021-0037, GHSA-j8q9-5rp9-4mv9",
"RUSTSEC-2021-0043, GHSA-w9vv-q986-vj7x",
"RUSTSEC-2021-0051, GHSA-6vmq-jh76-hq43",
"RUSTSEC-2021-0061",
"RUSTSEC-2021-0064",
"RUSTSEC-2021-0069, GHSA-qc36-q22q-cjw3",
"RUSTSEC-2021-0071",
"RUSTSEC-2021-0073, GHSA-x4qm-mcjq-v2gf",
"RUSTSEC-2021-0074, GHSA-5325-xw5m-phm3",
"RUSTSEC-2021-0076, GHSA-g4vj-x7v9-h82m",
"RUSTSEC-2021-0089, GHSA-w428-f65r-h4q2, GHSA-jf5h-cf95-w759",
"RUSTSEC-2021-0096",
"RUSTSEC-2021-0100, GHSA-fc7x-2cmc-8j2g, GHSA-xpww-g9jx-hp8r",
"RUSTSEC-2021-0103, GHSA-6p3c-v8vc-c244, GHSA-82hm-vh7g-hrh9",
"RUSTSEC-2021-0105, GHSA-5xg3-j2j6-rcx4",
"RUSTSEC-2021-0113, GHSA-cwvc-87xq-pc5m, GHSA-3hxh-7jxm-59x4",
"RUSTSEC-2021-0114, GHSA-r57r-j98g-587f, GHSA-p6gj-gpc8-f8xw",
"RUSTSEC-2021-0124, GHSA-fg7r-2g4j-5cgr",
"RUSTSEC-2021-0125, GHSA-3m6f-3gfg-4x56, GHSA-g4h2-4wvh-grc5",
"RUSTSEC-2021-0130, GHSA-qqmc-hwqp-8g2w, GHSA-v362-2895-h9r2",
"RUSTSEC-2021-0134",
"RUSTSEC-2021-0135, GHSA-wwh2-r387-g5rm",
"RUSTSEC-2021-0136",
"RUSTSEC-2021-0137",
"RUSTSEC-2021-0138, GHSA-jwh2-vrr9-vcp2",
"RUSTSEC-2021-0146",
"RUSTSEC-2022-0005",
"RUSTSEC-2022-0013, GHSA-m5pq-gvj9-9vr8",
"RUSTSEC-2022-0016, GHSA-gwc9-348x-qwv2",
"RUSTSEC-2022-0020, GHSA-8gj8-hv75-gp94",
"RUSTSEC-2022-0024",
"RUSTSEC-2022-0035, GHSA-qrjv-rf5q-qpxc",
"RUSTSEC-2022-0037, GHSA-xq3c-8gqm-v648",
"RUSTSEC-2022-0038, GHSA-4rx6-g5vg-5f3j",
"RUSTSEC-2022-0039",
"RUSTSEC-2022-0041, GHSA-qc84-gqf4-9926",
"RUSTSEC-2022-0045, GHSA-hrjv-pf36-jpmr",
"RUSTSEC-2022-0046, GHSA-xpp3-xrff-w6rh",
"RUSTSEC-2022-0050",
"RUSTSEC-2022-0052, GHSA-c439-chv8-8g2j",
"RUSTSEC-2022-0061",
"RUSTSEC-2022-0062, GHSA-fc4h-xcf3-qj5f",
"RUSTSEC-2022-0080",
"RUSTSEC-2022-0087, GHSA-4mjx-2gh5-ph8h",
"RUSTSEC-2022-0091",
"RUSTSEC-2023-0001, GHSA-7rrj-xr53-82p7",
"RUSTSEC-2023-0002",
"RUSTSEC-2023-0003, GHSA-m4ch-rfv5-x5g3",
"RUSTSEC-2023-0015, GHSA-mrrw-grhq-86gf",
"RUSTSEC-2023-0016, GHSA-5x36-7567-3cw6",
"RUSTSEC-2023-0018, GHSA-mc8h-8q98-g5hr",
"RUSTSEC-2023-0021, GHSA-ppjr-267j-5p9x",
"RUSTSEC-2023-0029, GHSA-wvc4-j7g5-4f79",
"RUSTSEC-2023-0030, GHSA-8vxc-r5wp-vgvc",
"RUSTSEC-2023-0031, GHSA-2qv5-7mw5-j3cg",
"RUSTSEC-2023-0034, GHSA-f8vr-r385-rh5r",
"RUSTSEC-2023-0037",
"RUSTSEC-2023-0043",
"RUSTSEC-2023-0044, GHSA-xcf7-rvmh-g6q4",
"RUSTSEC-2023-0045, GHSA-wfg4-322g-9vqv",
"RUSTSEC-2023-0052, GHSA-8qv2-5vq6-g2g7",
"RUSTSEC-2023-0053, GHSA-fh2r-99q2-6mmg",
"RUSTSEC-2023-0056, GHSA-49hh-fprx-m68g",
"RUSTSEC-2023-0057, GHSA-ghc8-5cgm-5rpf",
"RUSTSEC-2023-0060, GHSA-j7hp-h8jx-5ppr",
"RUSTSEC-2023-0063, GHSA-q8wc-j5m9-27w3",
"RUSTSEC-2023-0064, GHSA-rrjw-j4m2-mf34",
"RUSTSEC-2023-0065, GHSA-9mcr-873m-xcxp",
"RUSTSEC-2023-0072, GHSA-xphf-cx8h-7q9g",
"RUSTSEC-2023-0075, GHSA-r24f-hg58-vfrw",
"RUSTSEC-2023-0076",
"RUSTSEC-2023-0078, GHSA-8f24-6m29-wm2r",
"RUSTSEC-2024-0002, GHSA-875g-mfp6-g7f9",
"RUSTSEC-2024-0003, GHSA-8r5v-vm4m-4g25",
"RUSTSEC-2024-0009, GHSA-9f9p-cp3c-72jf",
"RUSTSEC-2024-0012, GHSA-rr69-rxr6-8qwf",
"RUSTSEC-2024-0015",
"RUSTSEC-2024-0018, GHSA-xfhw-6mc4-mgxf",
"RUSTSEC-2024-0021, GHSA-4v52-7q2x-v4xj",
"RUSTSEC-2024-0331",
"RUSTSEC-2024-0334",
"RUSTSEC-2024-0336, GHSA-6g7w-8wpp-frhj",
"RUSTSEC-2024-0338, GHSA-8724-5xmm-w5xq",
"RUSTSEC-2024-0344, GHSA-x4gp-pqpj-f43q",
"RUSTSEC-2024-0354, GHSA-j8cm-g7r6-hfpq",
"RUSTSEC-2024-0356, GHSA-4qg4-cvh2-crgg",
"RUSTSEC-2024-0360, GHSA-66fw-43h8-f8p3",
]

def get_modified_files_in_commit(commit_dir, commit_hash):
    path = os.path.abspath(commit_dir)
    result = subprocess.Popen(args='git show --pretty=\"format:\" --name-only '+commit_hash,cwd=path,
                            stdout=subprocess.PIPE,
                            stderr=subprocess.STDOUT,
                            shell=True,
                            start_new_session=True)
    modified_files = result.stdout.read().decode('utf-8').strip().split("\n")
    print(result)
    return modified_files


def process_cve_repos():

    cve_root_path = "./cve_repos"
    cve_dirs = [os.path.join(cve_root_path, cve_id)  for cve_id in cve_ids]
    cve_dirs = cve_dirs
    cve_repo_paths = [os.path.join(d,"fixed") for d in cve_dirs]

    cve_repo_paths = [[f.path for f in os.scandir(d) if f.is_dir()] for d in cve_repo_paths]

    ans = []
    for cve_repo_path in cve_repo_paths:
        modified_files= []
        cve_id = None
        for commit_dir in cve_repo_path:
            parts = commit_dir.split("/")
            cve_id = parts[2]
            commit_hash = parts[-1]
            try:
                modified_files_in_commit = get_modified_files_in_commit(commit_dir, commit_hash)
                print(f"对于CVE ID {cve_id}，提交 {commit_hash} 修改的文件如下：")
                for file in modified_files_in_commit:
                    print(file)
                modified_files.extend(modified_files_in_commit)

            except subprocess.CalledProcessError as e:
                print(f"执行git命令出现错误: {e}")
        row = {}
        row["cve_id"] = cve_id
        row["modified_files"] = modified_files
        ans.append(row)

    with open("commit_modified_files.csv", "w") as f:
        writer = csv.DictWriter(f, fieldnames=["cve_id", "modified_files"])
        writer.writeheader()
        for row in ans:
            writer.writerow(row)

if __name__ == "__main__":
    process_cve_repos()
    